enum AttendanceEnum {
  PRESENTE
  AUSENTE
}

model AttendanceSession {
  id               Int       @id @default(autoincrement())
  eventInstanceId  Int
  trainingModuleId Int
  modality         String
  checkIn          DateTime
  checkOut         DateTime?
  coordenates      String?
  supportId        Int

  createdAt DateTime @default(now())
  createdBy Int

  EventInstance   EventInstance     @relation(fields: [eventInstanceId], references: [id])
  Support         Person            @relation(fields: [supportId], references: [id])
  EventAttendance EventAttendance[]
  TrainingModule  TrainingModule    @relation(fields: [trainingModuleId], references: [id])

  @@unique([supportId, checkOut])
  @@index([trainingModuleId])
  @@index([supportId])
  @@index([eventInstanceId])
  @@index([createdAt])
}

model EventAttendance {
  id                   Int               @id @default(autoincrement())
  attendanceSessionId  Int
  teacherId            Int
  checkIn              DateTime
  checkOut             DateTime?
  status               AttendanceEnum
  comment              String?
  justificationFileUrl String?
  Person               Person            @relation(fields: [teacherId], references: [id])
  AttendanceSession    AttendanceSession @relation(fields: [attendanceSessionId], references: [id])
  createdAt            DateTime          @default(now())
  updatedAt            DateTime          @updatedAt
  createdBy            Int
  updatedBy            Int?

  @@unique([teacherId, attendanceSessionId])
}

model WorkAttendance {
  id                Int            @id @default(autoincrement())
  personId          Int // DE QUIÃ‰N es la asistencia (obligatorio)
  trainingModuleId  Int
  checkIn           DateTime
  checkOut          DateTime?
  status            AttendanceEnum @default(PRESENTE)
  comment           String?
  justificationFile String?
  coordenates       String?

  Person         Person         @relation(fields: [personId], references: [id])
  TrainingModule TrainingModule @relation(fields: [trainingModuleId], references: [id])

  @@index([trainingModuleId])
}
