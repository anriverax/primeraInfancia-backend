enum AttendanceEnum {
  PRESENTE
  AUSENTE
}

model AttendanceSession {
  id              Int       @id @default(autoincrement())
  eventInstanceId Int
  modality        String
  checkIn         DateTime
  checkOut        DateTime?
  coordenates     String?
  supportId       Int

  createdAt DateTime @default(now())
  createdBy Int

  EventInstance   EventInstance     @relation(fields: [eventInstanceId], references: [id])
  Support         Person            @relation(fields: [supportId], references: [id])
  EventAttendance EventAttendance[]

  @@unique([supportId, checkOut])
}

model EventAttendance {
  id                   Int               @id @default(autoincrement())
  attendanceSessionId  Int
  teacherId            Int
  checkIn              DateTime
  checkOut             DateTime?
  status               AttendanceEnum
  comment              String?
  justificationFileUrl String?
  Person               Person            @relation(fields: [teacherId], references: [id])
  AttendanceSession    AttendanceSession @relation(fields: [attendanceSessionId], references: [id])
  createdAt            DateTime          @default(now())
  updatedAt            DateTime          @updatedAt
  createdBy            Int
  updatedBy            Int?

  @@unique([teacherId, attendanceSessionId])
}

model WorkAttendance {
  id                Int            @id @default(autoincrement())
  personId          Int // DE QUIÃ‰N es la asistencia (obligatorio)
  date              DateTime       @db.Date
  checkIn           DateTime
  checkOut          DateTime?
  status            AttendanceEnum @default(PRESENTE)
  comment           String?
  justificationFile String?
  coordinates       String?

  Person Person @relation(fields: [personId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  updatedBy Int? // solo para correcciones posteriores

  @@unique([personId, date])
  @@index([date])
  @@index([personId])
}
